{% extends "base.html" %}

{% block title %}Step 4: ìƒì„¸ë³´ê¸° ì„¤ì • - Auto-Board{% endblock %}

{% block content %}
{% include 'common/nav.html' %}

<div class="p-8 max-w-6xl mx-auto w-full">
    <div class="space-y-8">
        <!-- Progress Indicator -->
        <div class="flex items-center justify-between">
            <div class="flex-1">
                <div class="flex justify-between mb-2">
                    <span class="text-sm font-medium text-gray-700">ë‹¨ê³„ 4/4: ìƒì„¸ë³´ê¸° ì„¤ì •</span>
                    <span class="text-sm text-gray-500">100%</span>
                </div>
                <div class="h-2 bg-gray-200 rounded-full overflow-hidden">
                    <div class="h-full w-full bg-indigo-500 rounded-full transition-all duration-300"></div>
                </div>
            </div>
        </div>

        <!-- Board Info -->
        <div class="bg-indigo-50 border border-indigo-200 rounded-xl p-6">
            <p class="text-sm text-indigo-700">
                <span class="font-semibold">{{ board.name }}</span> (ID: {{ board.id }})
            </p>
        </div>

        <!-- Main Configuration -->
        <div class="bg-white rounded-xl p-8 shadow-sm border border-gray-100">
            <h2 class="text-2xl font-bold text-[#1a1a2e] mb-6 border-b pb-4">ìƒì„¸ë³´ê¸°(View) ì„¤ì •</h2>

            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-8 text-sm text-blue-700">
                <p class="font-semibold mb-1">ğŸ’¡ íŒ:</p>
                <p>ê¸°ë¡ì„ ìƒì„¸ë³´ê¸°í•  ë•Œ ê° í•„ë“œë¥¼ ì–´ë–»ê²Œ í‘œì‹œí• ì§€ ì„¤ì •í•©ë‹ˆë‹¤. í•„ë“œì˜ ìˆœì„œ, ê·¸ë£¹í•‘, ìŠ¤íƒ€ì¼, í¬ë§·ì„ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
            </div>

            <div id="fieldsContainer" class="space-y-5 mb-8">
                <!-- Column cards will be dynamically generated here -->
            </div>

            <!-- Field Type Reference -->
            <div class="bg-gray-50 p-4 rounded-lg text-sm text-gray-600">
                <p class="font-semibold mb-2">í‘œì‹œ íƒ€ì…:</p>
                <ul class="grid grid-cols-2 gap-2 text-xs">
                    <li><span class="font-mono bg-white px-2 py-1 rounded">text</span> - ì¼ë°˜ í…ìŠ¤íŠ¸</li>
                    <li><span class="font-mono bg-white px-2 py-1 rounded">date</span> - ë‚ ì§œ (í¬ë§· ê°€ëŠ¥)</li>
                    <li><span class="font-mono bg-white px-2 py-1 rounded">datetime</span> - ë‚ ì§œ+ì‹œê°„</li>
                    <li><span class="font-mono bg-white px-2 py-1 rounded">stars</span> - ë³„ì  í‘œì‹œ</li>
                    <li><span class="font-mono bg-white px-2 py-1 rounded">currency</span> - í†µí™” í‘œì‹œ</li>
                    <li><span class="font-mono bg-white px-2 py-1 rounded">boolean</span> - ì°¸/ê±°ì§“</li>
                    <li><span class="font-mono bg-white px-2 py-1 rounded">badge</span> - ë°°ì§€ (ìƒ‰ìƒ ë§µ)</li>
                    <li><span class="font-mono bg-white px-2 py-1 rounded">html</span> - HTML ì½˜í…ì¸ </li>
                    <li><span class="font-mono bg-white px-2 py-1 rounded">list</span> - ëª©ë¡/ë°°ì§€ ëª©ë¡</li>
                    <li><span class="font-mono bg-white px-2 py-1 rounded">file_link</span> - íŒŒì¼ ë§í¬</li>
                </ul>
            </div>
        </div>

        <!-- Navigation Buttons -->
        <div class="flex justify-between gap-4">
            <a id="prevStepBtn" href="/boards/new/step3/"
                class="px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-bold transition-colors">
                ì´ì „ ë‹¨ê³„
            </a>
            <button type="button" onclick="wizardStep4.submit()"
                class="px-8 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 font-bold shadow-lg transform active:scale-95 transition-all">
                ë§ˆë¬´ë¦¬ (ì™„ë£Œ)
            </button>
        </div>
    </div>
</div>

<style>
.field-card {
    padding: 1.5rem;
    border-radius: 0.75rem;
    border: 1px solid #e5e7eb;
    box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
    transition: all 200ms ease;
}

.field-card:hover {
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
}

/* ì–¼ë£©ë§ íŒ¨í„´: í™€ìˆ˜ ì¹´ë“œ - í°ìƒ‰ */
.field-card:nth-child(odd) {
    background-color: #ffffff;
}

/* ì–¼ë£©ë§ íŒ¨í„´: ì§ìˆ˜ ì¹´ë“œ - ì—°í•œ íŒŒë€ìƒ‰ */
.field-card:nth-child(even) {
    background-color: #eef2ff;
}

/* ì¹´ë“œ í—¤ë” ìŠ¤íƒ€ì¼ ê°•í™” */
.field-card > div:nth-child(2) {
    margin-bottom: 1rem;
    padding-bottom: 1rem;
    border-bottom: 1px solid #d1d5db;
}

.field-card.section-header {
    background-color: #f9fafb;
    border-color: #d1d5db;
}

/* ìì‹ ìš”ì†Œë“¤ ì‚¬ì´ì˜ ê°„ê²© */
.field-card > div {
    margin-bottom: 0.75rem;
}

.field-card > div:last-child {
    margin-bottom: 0;
}
</style>

<script>
// Variables from Jinja2 template - Define as window properties for global access
window.columnsData = {{ columns | tojson }};
window.viewConfig = {{ view_config | tojson if view_config else 'null' }};
window.boardData = {{ board | tojson }};
window.boardId = {{ board.id }};
</script>

<script src="/static/js/wizard/step4_view.js"></script>

<script>
// Initialize on page load (DOMContentLoadedëŠ” step4_view.jsì—ì„œ í•œ ë²ˆë§Œ ì‹¤í–‰)
document.addEventListener('DOMContentLoaded', () => {
    console.log('\n[STEP4-DOM] DOMContentLoaded ì´ë²¤íŠ¸ ë°œìƒ');

    // Set up navigation links
    const prevBtn = document.getElementById('prevStepBtn');
    if (prevBtn) {
        prevBtn.href = `/boards/new/step3/${window.boardId}`;
    }

    // Initialize wizard step 4
    wizardStep4.init();
    console.log('[STEP4-DOM] âœ“ init() í˜¸ì¶œ ì™„ë£Œ\n');
});
</script>
{% endblock %}
